<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§¤ë‹ˆì € ëŒ€ì‹œë³´ë“œ - ì¹˜ê³¼ë³‘ì› ì§„ë‹¨ ì‹œìŠ¤í…œ</title>
    <link rel="stylesheet" href="css/style.css">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        body {
            background: linear-gradient(135deg, #1f2937, #374151);
            min-height: 100vh;
        }

        .dashboard-header {
            background: linear-gradient(135deg, #1f2937, #111827);
            color: white;
            padding: 30px 20px;
            border-radius: 12px;
            margin-bottom: 30px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
        }

        .dashboard-header h1 {
            font-size: 2rem;
            margin-bottom: 8px;
            color: white;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .dashboard-header p {
            font-size: 1rem;
            opacity: 0.85;
            margin: 0;
        }

        .back-button {
            display: inline-block;
            background: rgba(255, 255, 255, 0.15);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.9rem;
            margin-bottom: 20px;
            transition: all 0.3s;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.25);
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .dashboard-card {
            background: white;
            border-radius: 12px;
            padding: 25px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
            transition: transform 0.3s;
        }

        .dashboard-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
        }

        .dashboard-card h2 {
            font-size: 1.3rem;
            color: #1f2937;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .dashboard-card p {
            color: #6b7280;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .card-stats {
            display: flex;
            justify-content: space-between;
            gap: 15px;
            margin-top: 20px;
        }

        .stat-item {
            flex: 1;
            text-align: center;
            padding: 15px;
            background: #f9fafb;
            border-radius: 8px;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2563eb;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.85rem;
            color: #6b7280;
        }

        .btn-dashboard {
            display: inline-block;
            background: linear-gradient(135deg, #2563eb, #1e40af);
            color: white;
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
            border: none;
            cursor: pointer;
        }

        .btn-dashboard:hover {
            background: linear-gradient(135deg, #1e40af, #1e3a8a);
            transform: translateY(-2px);
        }

        .info-section {
            background: white;
            border-radius: 12px;
            padding: 25px;
            margin-top: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);
        }

        .info-section h3 {
            font-size: 1.2rem;
            color: #1f2937;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .dashboard-header h1 {
                font-size: 1.5rem;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .card-stats {
                flex-direction: column;
            }
        }

        /* ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ */
        .auth-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }

        .auth-modal {
            background: white;
            border-radius: 16px;
            padding: 40px;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.5);
            text-align: center;
        }

        .auth-modal h2 {
            font-size: 1.5rem;
            color: #1f2937;
            margin-bottom: 10px;
        }

        .auth-modal p {
            color: #6b7280;
            margin-bottom: 25px;
            font-size: 0.95rem;
        }

        .auth-modal input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1.2rem;
            text-align: center;
            letter-spacing: 0.3em;
            margin-bottom: 20px;
            font-weight: 600;
        }

        .auth-modal input:focus {
            outline: none;
            border-color: #2563eb;
        }

        .auth-modal button {
            width: 100%;
            background: linear-gradient(135deg, #2563eb, #1e40af);
            color: white;
            padding: 15px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .auth-modal button:hover {
            background: linear-gradient(135deg, #1e40af, #1e3a8a);
            transform: translateY(-2px);
        }

        .auth-error {
            color: #dc2626;
            font-size: 0.9rem;
            margin-top: 10px;
            display: none;
        }

        .dashboard-content {
            display: none;
        }

        .dashboard-content.authenticated {
            display: block;
        }
    </style>
</head>
<body>
    <!-- ë¹„ë°€ë²ˆí˜¸ ì¸ì¦ ëª¨ë‹¬ -->
    <div class="auth-overlay" id="authOverlay">
        <div class="auth-modal">
            <h2>ğŸ” ë§¤ë‹ˆì € ì¸ì¦</h2>
            <p>ë§¤ë‹ˆì € ëŒ€ì‹œë³´ë“œì— ì ‘ê·¼í•˜ë ¤ë©´<br>ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ì„¸ìš”.</p>
            <input
                type="password"
                id="passwordInput"
                placeholder="â€¢â€¢â€¢â€¢â€¢â€¢"
                maxlength="6"
                autocomplete="off"
            >
            <button onclick="verifyPassword()">í™•ì¸</button>
            <p class="auth-error" id="authError">ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
            <a href="index.html" style="display: inline-block; margin-top: 15px; color: #6b7280; text-decoration: none; font-size: 0.9rem;">
                â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°
            </a>
        </div>
    </div>

    <div class="dashboard-content" id="dashboardContent">
    <div class="container">
        <a href="index.html" class="back-button">â† ë©”ì¸ìœ¼ë¡œ ëŒì•„ê°€ê¸°</a>

        <div class="dashboard-header">
            <h1>ğŸ” ë§¤ë‹ˆì € ëŒ€ì‹œë³´ë“œ</h1>
            <p>ì¹˜ê³¼ë³‘ì› ì§„ë‹¨ ì‹œìŠ¤í…œ ê´€ë¦¬ ë° í†µê³„</p>
        </div>

        <main>
            <!-- ìƒë‹¨ ìš”ì•½ í†µê³„ (ì»´íŒ©íŠ¸) -->
            <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                <div style="display: flex; justify-content: space-around; align-items: center; flex-wrap: wrap; gap: 15px;">
                    <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ˆ í†µê³„ -->
                </div>
            </div>

            <!-- í•„í„° ë° ê²€ìƒ‰ ë°” -->
            <div style="background: white; border-radius: 12px; padding: 20px; margin-bottom: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                <div style="display: flex; gap: 15px; flex-wrap: wrap; align-items: center;">
                    <div style="flex: 1; min-width: 200px;">
                        <input type="text" placeholder="ğŸ” ë³‘ì›ëª… ë˜ëŠ” ì›ì¥ëª… ê²€ìƒ‰..." style="width: 100%; padding: 10px 15px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.9rem;">
                    </div>
                    <select style="padding: 10px 15px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.9rem; cursor: pointer;">
                        <option>ì „ì²´ ì§„ë‹¨</option>
                        <option>1ë²ˆ: ìˆ˜ìµ ë‹¨ê³„ë³„</option>
                        <option>2ë²ˆ: ì›ì¥ ìŠ¤íƒ€ì¼</option>
                        <option>í†µí•© ì™„ë£Œ</option>
                    </select>
                    <select style="padding: 10px 15px; border: 2px solid #e5e7eb; border-radius: 8px; font-size: 0.9rem; cursor: pointer;">
                        <option>ìµœê·¼ 7ì¼</option>
                        <option>ìµœê·¼ 30ì¼</option>
                        <option>ìµœê·¼ 3ê°œì›”</option>
                        <option>ì „ì²´ ê¸°ê°„</option>
                    </select>
                    <button style="padding: 10px 20px; background: #2563eb; color: white; border: none; border-radius: 8px; font-size: 0.9rem; cursor: pointer; font-weight: 600;">ì´ˆê¸°í™”</button>
                </div>
            </div>

            <!-- ì§„ë‹¨ ëª©ë¡ í…Œì´ë¸” (ë©”ì¸) -->
            <div style="background: white; border-radius: 12px; padding: 25px; box-shadow: 0 4px 15px rgba(0, 0, 0, 0.2);">
                <h3 style="font-size: 1.2rem; color: #1f2937; margin-bottom: 20px;">ğŸ“‹ ì§„ë‹¨ ëª©ë¡</h3>
                <div style="overflow-x: auto;">
                    <table style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr style="background: #f9fafb; border-bottom: 2px solid #e5e7eb;">
                                <th style="padding: 12px; text-align: left; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">ì§„ë‹¨ì¼</th>
                                <th style="padding: 12px; text-align: left; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">ë³‘ì›ëª…</th>
                                <th style="padding: 12px; text-align: left; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">ì›ì¥ëª…</th>
                                <th style="padding: 12px; text-align: left; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">ì§€ì—­</th>
                                <th style="padding: 12px; text-align: center; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">ì¸ë ¥</th>
                                <th style="padding: 12px; text-align: center; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">1ë²ˆ ì§„ë‹¨</th>
                                <th style="padding: 12px; text-align: center; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">2ë²ˆ ì§„ë‹¨</th>
                                <th style="padding: 12px; text-align: center; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">ì´ë©”ì¼</th>
                                <th style="padding: 12px; text-align: center; font-size: 0.85rem; color: #1f2937; white-space: nowrap;">ìƒì„¸</th>
                            </tr>
                        </thead>
                        <tbody id="diagnosisTableBody">
                            <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ˆ ë‚´ìš© -->
                        </tbody>
                    </table>
                </div>

                <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
                <div style="display: flex; justify-content: center; align-items: center; gap: 10px; margin-top: 20px;">
                    <button style="padding: 8px 12px; border: 1px solid #e5e7eb; background: white; border-radius: 6px; cursor: pointer;">â€¹</button>
                    <button style="padding: 8px 12px; border: 1px solid #2563eb; background: #2563eb; color: white; border-radius: 6px; font-weight: 600;">1</button>
                    <button style="padding: 8px 12px; border: 1px solid #e5e7eb; background: white; border-radius: 6px; cursor: pointer;">2</button>
                    <button style="padding: 8px 12px; border: 1px solid #e5e7eb; background: white; border-radius: 6px; cursor: pointer;">3</button>
                    <button style="padding: 8px 12px; border: 1px solid #e5e7eb; background: white; border-radius: 6px; cursor: pointer;">â€º</button>
                </div>
            </div>
        </main>

        <footer style="margin-top: 40px;">
            <p>&copy; 2026 ì¹˜ê³¼ë³‘ì› ì»¨ì„¤íŒ… ì†”ë£¨ì…˜ | ë§¤ë‹ˆì € ëŒ€ì‹œë³´ë“œ</p>
        </footer>
    </div>
    </div>

    <!-- ìƒì„¸ ì •ë³´ ëª¨ë‹¬ -->
    <div id="detailModal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.7); z-index: 3000; align-items: center; justify-content: center;">
        <div style="background: white; border-radius: 16px; padding: 40px; max-width: 700px; width: 90%; max-height: 90vh; overflow-y: auto;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
                <h2 id="detailTitle" style="color: #1f2937; font-size: 1.5rem; margin: 0;"></h2>
                <button onclick="closeDetail()" style="background: none; border: none; font-size: 1.5rem; cursor: pointer; color: #6b7280;">âœ•</button>
            </div>

            <div id="detailContent" style="color: #4b5563; line-height: 1.8;">
                <!-- ë™ì ìœ¼ë¡œ ì±„ì›Œì§ˆ ë‚´ìš© -->
            </div>
        </div>
    </div>

    <script>
        // ë¹„ë°€ë²ˆí˜¸ ì„¤ì • (963314)
        const MANAGER_PASSWORD = '963314';
        const AUTH_SESSION_KEY = 'managerAuthenticated';

        // ì‹¤ì œ ì§„ë‹¨ ë°ì´í„°ë¥¼ ì €ì¥í•  ë³€ìˆ˜
        let diagnosisData = [];

        // í…ŒìŠ¤íŠ¸ ë°ì´í„° (ê°œë°œìš© - ì‹¤ì œ ë°ì´í„°ê°€ ì—†ì„ ë•Œë§Œ ì‚¬ìš©)
        const testData = {
            1: {
                clinicName: 'í™”ì´íŠ¸ì„œìš¸ì¹˜ê³¼',
                directorName: 'ì„ì˜ì¼',
                region: 'ëŒ€ì „ ì¤‘êµ¬',
                staff: 'ì˜ì‚¬ 1ëª… / ê°„í˜¸ì‚¬ 1ëª… / ìƒë‹´ì‚¬ 1ëª…',
                date: '2026-01-07',
                diagnosis1: {
                    type: '3í˜• (ì›ì¥ ê³¼ë¶€í•˜)',
                    score: 18,
                    secondary: '1í˜• (ìˆ˜ìµ ì •ì²´Â·ê°ì†Œ)',
                    description: 'ì›ì¥ë‹˜ì´ ìƒë‹´ê³¼ ì§„ë£Œë¥¼ ëª¨ë‘ ë‹´ë‹¹í•˜ì—¬ ê³¼ë¶€í•˜ ìƒíƒœì´ë©°, ì´ë¡œ ì¸í•´ í™˜ì ì´íƒˆë„ ë°œìƒí•˜ê³  ìˆìŠµë‹ˆë‹¤.',
                    scores: [12, 10, 18, 8, 6] // 1í˜•, 2í˜•, 3í˜•, 4í˜•, 5í˜•
                },
                diagnosis2: {
                    type: 'Dí˜• (ìˆ˜ìµÂ·ê²½ì˜í˜•)',
                    score: 24,
                    secondary: 'Aí˜• (ê²°ë‹¨Â·ì†ë„í˜•)',
                    description: 'ROIì™€ ìˆ˜ìµì„±ì„ ì¤‘ì‹œí•˜ë©´ì„œë„ ë¹ ë¥¸ ì‹¤í–‰ì„ ì„ í˜¸í•˜ëŠ” ê· í˜•ì¡íŒ ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.',
                    scores: [18, 12, 10, 24, 14], // Aí˜•, Bí˜•, Cí˜•, Dí˜•, Eí˜•
                    essayAnswers: [
                        'í˜„ì¬ ê°€ì¥ ê³ ë¯¼ë˜ëŠ” ë¶€ë¶„ì€ í™˜ì ìƒë‹´ ì‹œê°„ ëŒ€ë¹„ ì¹˜ë£Œ ê²°ì •ë¥ ì´ ë‚®ë‹¤ëŠ” ì ì…ë‹ˆë‹¤. ì¶©ë¶„íˆ ì„¤ëª…ì„ í•´ë„ í™˜ìë“¤ì´ ê²°ì •ì„ ë¯¸ë£¨ê±°ë‚˜ íƒ€ ë³‘ì›ê³¼ ë¹„êµí•˜ëŠ” ê²½ìš°ê°€ ë§ì•„, ìƒë‹´ì˜ íš¨ìœ¨ì„±ì„ ë†’ì´ê³  ì‹¶ìŠµë‹ˆë‹¤. ë˜í•œ ì§ì›ë“¤ì˜ í™˜ì ì‘ëŒ€ ì—­ëŸ‰ì„ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ì‹œìŠ¤í…œì´ ë¶€ì¡±í•´ ì´ ë¶€ë¶„ë„ ê°œì„ ì´ í•„ìš”í•©ë‹ˆë‹¤.',
                        '3ë…„ í›„ì—ëŠ” ëŒ€ì „ ì§€ì—­ì—ì„œ "ê°€ì¥ ë¯¿ì„ ìˆ˜ ìˆê³  ì „ë¬¸ì ì¸ ì¹˜ê³¼"ë¡œ ìë¦¬ì¡ê³  ì‹¶ìŠµë‹ˆë‹¤. í™˜ìë“¤ì´ ìë°œì ìœ¼ë¡œ ì¶”ì²œí•˜ê³  ì‹¶ì–´í•˜ëŠ” ë³‘ì›, ì§ì›ë“¤ë„ ìë¶€ì‹¬ì„ ê°€ì§€ê³  ì¼í•  ìˆ˜ ìˆëŠ” ë³‘ì›ì´ ë˜ì—ˆìœ¼ë©´ í•©ë‹ˆë‹¤. ë˜í•œ ì§€ì—­ ì‚¬íšŒì— ë¬¸í™”ì ìœ¼ë¡œë„ ê¸°ì—¬í•˜ëŠ” ì¹˜ê³¼ë¡œ ë¸Œëœë”©í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤.',
                        'ì‹œê°„ê³¼ ì˜ˆì‚°ì´ ì¶©ë¶„í•˜ë‹¤ë©´ ê°€ì¥ ë¨¼ì € ì§ì› êµìœ¡ê³¼ í™˜ì ê²½í—˜ ê°œì„ ì— íˆ¬ìí•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. íŠ¹íˆ ì›ì¥ê³¼ ì§ì›ë“¤ì´ í™˜ì ìƒë‹´ ì—­ëŸ‰ì„ ì²´ê³„ì ìœ¼ë¡œ í–¥ìƒì‹œí‚¬ ìˆ˜ ìˆëŠ” êµìœ¡ í”„ë¡œê·¸ë¨ì„ ë„ì…í•˜ê³ , AI ê¸°ë°˜ ìƒë‹´ ë¶„ì„ ì‹œìŠ¤í…œ ê°™ì€ í˜ì‹ ì ì¸ ë„êµ¬ë„ ê²€í† í•˜ê³  ì‹¶ìŠµë‹ˆë‹¤. ê·¸ ë‹¤ìŒìœ¼ë¡œëŠ” ë³‘ì› ì¸í…Œë¦¬ì–´ì™€ í™˜ì ëŒ€ê¸° ê³µê°„ì„ ë” í¸ì•ˆí•˜ê³  ì°¨ë³„í™”ëœ ë¶„ìœ„ê¸°ë¡œ ë§Œë“¤ê³  ì‹¶ìŠµë‹ˆë‹¤.'
                    ]
                }
            },
            2: {
                clinicName: 'ê°•ë‚¨ë¸Œë¼ì´íŠ¸ì¹˜ê³¼',
                directorName: 'ê¹€ìˆ˜ì§„',
                region: 'ì„œìš¸ ê°•ë‚¨',
                staff: 'ì˜ì‚¬ 2ëª… / ê°„í˜¸ì‚¬ 3ëª… / ìƒë‹´ì‚¬ 2ëª…',
                date: '2026-01-07',
                diagnosis1: {
                    type: '5í˜• (ê³ ìˆ˜ìµÂ·ë¸Œëœë“œí˜•)',
                    score: 22,
                    secondary: '4í˜• (ìˆ˜ìµ ì•ˆì •Â·í™•ì¥ ì¤€ë¹„)',
                    description: 'í™˜ì ë§Œì¡±ë„ê°€ ë†’ê³  ì‹ ë¢° ê¸°ë°˜ì´ êµ¬ì¶•ë˜ì–´ ìˆìœ¼ë©°, í™•ì¥ì„ ì¤€ë¹„í•  ìˆ˜ ìˆëŠ” ì•ˆì •ì ì¸ ë‹¨ê³„ì…ë‹ˆë‹¤.',
                    scores: [6, 8, 10, 18, 22]
                },
                diagnosis2: {
                    type: 'Eí˜• (í™˜ìÂ·ì‹ ë¢°í˜•)',
                    score: 20,
                    secondary: 'Cí˜• (íŒ€Â·êµìœ¡í˜•)',
                    description: 'í™˜ì ê²½í—˜ê³¼ ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ë©°, ì§ì› êµìœ¡ì—ë„ ê´€ì‹¬ì´ ë†’ì€ ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.',
                    scores: [10, 8, 16, 12, 20]
                }
            },
            3: {
                clinicName: 'ìŠ¤ë§ˆì¼365ì¹˜ê³¼',
                directorName: 'ë°•ë¯¼ìˆ˜',
                region: 'ë¶€ì‚° í•´ìš´ëŒ€',
                staff: 'ì˜ì‚¬ 1ëª… / ê°„í˜¸ì‚¬ 2ëª… / ìƒë‹´ì‚¬ 1ëª…',
                date: '2026-01-07',
                diagnosis1: {
                    type: '2í˜• (ìˆ˜ìµ ìœ ì§€Â·ë¶ˆì•ˆì •)',
                    score: 16,
                    secondary: '1í˜• (ìˆ˜ìµ ì •ì²´Â·ê°ì†Œ)',
                    description: 'ì›”ë³„ ë§¤ì¶œ ë³€ë™ì„±ì´ í¬ê³  ìƒë‹´ ê²°ê³¼ê°€ ì¼ì •í•˜ì§€ ì•Šì•„ ë¶ˆì•ˆì •í•œ ìƒíƒœì…ë‹ˆë‹¤.',
                    scores: [14, 16, 10, 8, 6]
                },
                diagnosis2: null
            },
            4: {
                clinicName: 'ì—°ì„¸í”„ë¼ì„ì¹˜ê³¼',
                directorName: 'ì´ì¤€í˜¸',
                region: 'ì¸ì²œ ì†¡ë„',
                staff: 'ì˜ì‚¬ 3ëª… / ê°„í˜¸ì‚¬ 4ëª… / ìƒë‹´ì‚¬ 3ëª…',
                date: '2026-01-06',
                diagnosis1: {
                    type: '4í˜• (ìˆ˜ìµ ì•ˆì •Â·í™•ì¥ ì¤€ë¹„)',
                    score: 26,
                    secondary: '5í˜• (ê³ ìˆ˜ìµÂ·ë¸Œëœë“œí˜•)',
                    description: 'ì‹œìŠ¤í…œì´ ì•ˆì •ì ìœ¼ë¡œ êµ¬ì¶•ë˜ì–´ ìˆê³  í™•ì¥ì„ ìœ„í•œ ì¤€ë¹„ê°€ ë˜ì–´ ìˆëŠ” ë‹¨ê³„ì…ë‹ˆë‹¤.',
                    scores: [6, 10, 12, 26, 20]
                },
                diagnosis2: {
                    type: 'Bí˜• (êµ¬ì¡°Â·ì•ˆì •í˜•)',
                    score: 28,
                    secondary: 'Dí˜• (ìˆ˜ìµÂ·ê²½ì˜í˜•)',
                    description: 'ê¸°ì¤€ê³¼ ì‹œìŠ¤í…œí™”ë¥¼ ì¤‘ì‹œí•˜ë©° ê²½ì˜ ì§€í‘œë¥¼ ì²´ê³„ì ìœ¼ë¡œ ê´€ë¦¬í•˜ëŠ” ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.',
                    scores: [12, 28, 10, 22, 14]
                }
            },
            5: {
                clinicName: 'ì„œìš¸ìš°ë¦¬ì¹˜ê³¼',
                directorName: 'ìµœì€ì˜',
                region: 'ì„œìš¸ ë§ˆí¬',
                staff: 'ì˜ì‚¬ 1ëª… / ê°„í˜¸ì‚¬ 1ëª… / ìƒë‹´ì‚¬ 0ëª…',
                date: '2026-01-06',
                diagnosis1: {
                    type: '1í˜• (ìˆ˜ìµ ì •ì²´Â·ê°ì†Œ)',
                    score: 20,
                    secondary: '2í˜• (ìˆ˜ìµ ìœ ì§€Â·ë¶ˆì•ˆì •)',
                    description: 'í™˜ìê°€ ì§€ì†ì ìœ¼ë¡œ ê°ì†Œí•˜ê³  ìˆìœ¼ë©° ìƒë‹´ì—ì„œ ì„ íƒë°›ì„ ì´ìœ ë¥¼ ìƒì–´ê°€ê³  ìˆìŠµë‹ˆë‹¤.',
                    scores: [20, 16, 12, 8, 6]
                },
                diagnosis2: {
                    type: 'Aí˜• (ê²°ë‹¨Â·ì†ë„í˜•)',
                    score: 22,
                    secondary: 'Eí˜• (í™˜ìÂ·ì‹ ë¢°í˜•)',
                    description: 'ë¹ ë¥¸ ì‹¤í–‰ì„ ì„ í˜¸í•˜ë©´ì„œë„ í™˜ìì™€ì˜ ê´€ê³„ë¥¼ ì¤‘ì‹œí•˜ëŠ” ìŠ¤íƒ€ì¼ì…ë‹ˆë‹¤.',
                    scores: [22, 10, 12, 14, 18]
                }
            }
        };

        // ìƒì„¸ë³´ê¸° í•¨ìˆ˜ - í†µí•© ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™
        function showDetail(index) {
            // ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬ëœ ë°ì´í„°ì—ì„œ ê°€ì ¸ì˜¤ê¸°
            const sortedData = [...diagnosisData].sort((a, b) => b.timestamp - a.timestamp);
            const data = sortedData[index];
            if (!data) return;

            // sessionStorageì— ì„ íƒí•œ ì§„ë‹¨ ë°ì´í„° ì €ì¥
            sessionStorage.setItem('selectedDiagnosis', JSON.stringify(data));

            // í†µí•© ê²°ê³¼ í˜ì´ì§€ë¡œ ì´ë™ (ìƒˆ íƒ­)
            window.open('manager-view-report.html', '_blank');
        }

        // ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
        let chartInstances = [];

        // ìƒì„¸ë³´ê¸° ë‹«ê¸°
        function closeDetail() {
            document.getElementById('detailModal').style.display = 'none';
            // ëª¨ë“  ì°¨íŠ¸ ì¸ìŠ¤í„´ìŠ¤ ì œê±°
            chartInstances.forEach(chart => {
                if (chart) chart.destroy();
            });
            chartInstances = [];
        }

        // ì°¨íŠ¸ ìƒì„± ì‹œ ì¸ìŠ¤í„´ìŠ¤ ì €ì¥
        function drawChart1(id, diagnosis) {
            const ctx = document.getElementById(`chart1_${id}`);
            if (!ctx) return;

            const labels = ['1í˜•\nì •ì²´Â·ê°ì†Œ', '2í˜•\nìœ ì§€Â·ë¶ˆì•ˆì •', '3í˜•\nì›ì¥ê³¼ë¶€í•˜', '4í˜•\nì•ˆì •Â·í™•ì¥', '5í˜•\në¸Œëœë“œí˜•'];

            const primaryIndex = diagnosis.scores.indexOf(Math.max(...diagnosis.scores));
            const sortedScores = [...diagnosis.scores].sort((a, b) => b - a);
            const secondaryScore = sortedScores[1];
            const secondaryIndex = diagnosis.scores.indexOf(secondaryScore);

            const pointBackgroundColors = diagnosis.scores.map((score, index) => {
                if (index === primaryIndex) return '#2563eb';
                if (index === secondaryIndex) return '#10b981';
                return '#9ca3af';
            });

            const pointRadius = diagnosis.scores.map((score, index) => {
                if (index === primaryIndex || index === secondaryIndex) return 6;
                return 4;
            });

            const chart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ìˆ˜ìµ ë‹¨ê³„ë³„ ì ìˆ˜',
                        data: diagnosis.scores,
                        fill: true,
                        backgroundColor: 'rgba(37, 99, 235, 0.2)',
                        borderColor: '#2563eb',
                        borderWidth: 2,
                        pointBackgroundColor: pointBackgroundColors,
                        pointBorderColor: pointBackgroundColors,
                        pointBorderWidth: 2,
                        pointRadius: pointRadius,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'ë³‘ì› ìˆ˜ìµ ë‹¨ê³„ë³„ 5ìœ í˜• ë¶„ì„',
                            font: { size: 14, weight: 'bold' }
                        }
                    },
                    scales: {
                        r: {
                            min: 0,
                            max: Math.max(...diagnosis.scores) + 5,
                            ticks: { stepSize: 5 }
                        }
                    }
                }
            });
            chartInstances.push(chart);
        }

        function drawChart2(id, diagnosis) {
            const ctx = document.getElementById(`chart2_${id}`);
            if (!ctx) return;

            const labels = ['Aí˜•\nê²°ë‹¨Â·ì†ë„', 'Bí˜•\nêµ¬ì¡°Â·ì•ˆì •', 'Cí˜•\níŒ€Â·êµìœ¡', 'Dí˜•\nìˆ˜ìµÂ·ê²½ì˜', 'Eí˜•\ní™˜ìÂ·ì‹ ë¢°'];

            const primaryIndex = diagnosis.scores.indexOf(Math.max(...diagnosis.scores));
            const sortedScores = [...diagnosis.scores].sort((a, b) => b - a);
            const secondaryScore = sortedScores[1];
            const secondaryIndex = diagnosis.scores.indexOf(secondaryScore);

            const pointBackgroundColors = diagnosis.scores.map((score, index) => {
                if (index === primaryIndex) return '#8b5cf6';
                if (index === secondaryIndex) return '#10b981';
                return '#9ca3af';
            });

            const pointRadius = diagnosis.scores.map((score, index) => {
                if (index === primaryIndex || index === secondaryIndex) return 6;
                return 4;
            });

            const chart = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'ì›ì¥ ìŠ¤íƒ€ì¼ ì ìˆ˜',
                        data: diagnosis.scores,
                        fill: true,
                        backgroundColor: 'rgba(139, 92, 246, 0.2)',
                        borderColor: '#8b5cf6',
                        borderWidth: 2,
                        pointBackgroundColor: pointBackgroundColors,
                        pointBorderColor: pointBackgroundColors,
                        pointBorderWidth: 2,
                        pointRadius: pointRadius,
                        pointHoverRadius: 8
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: { display: false },
                        title: {
                            display: true,
                            text: 'ì›ì¥ ìŠ¤íƒ€ì¼ 5ìœ í˜• ë¶„ì„',
                            font: { size: 14, weight: 'bold' }
                        }
                    },
                    scales: {
                        r: {
                            min: 0,
                            max: Math.max(...diagnosis.scores) + 5,
                            ticks: { stepSize: 5 }
                        }
                    }
                }
            });
            chartInstances.push(chart);
        }

        // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
        document.getElementById('detailModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDetail();
            }
        });

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ì¸ì¦ í™•ì¸
        window.addEventListener('DOMContentLoaded', function() {
            // ì„¸ì…˜ì— ì¸ì¦ ì •ë³´ê°€ ìˆëŠ”ì§€ í™•ì¸
            const isAuthenticated = sessionStorage.getItem(AUTH_SESSION_KEY);

            if (isAuthenticated === 'true') {
                // ì´ë¯¸ ì¸ì¦ë˜ì—ˆìœ¼ë©´ ëŒ€ì‹œë³´ë“œ í‘œì‹œ
                showDashboard();
            } else {
                // ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ì— í¬ì»¤ìŠ¤
                document.getElementById('passwordInput').focus();
            }

            // Enter í‚¤ë¡œë„ í™•ì¸ ê°€ëŠ¥í•˜ë„ë¡
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    verifyPassword();
                }
            });
        });

        // ë¹„ë°€ë²ˆí˜¸ í™•ì¸ í•¨ìˆ˜
        function verifyPassword() {
            const input = document.getElementById('passwordInput');
            const password = input.value.trim();
            const errorMsg = document.getElementById('authError');

            if (password === MANAGER_PASSWORD) {
                // ë¹„ë°€ë²ˆí˜¸ ì¼ì¹˜
                sessionStorage.setItem(AUTH_SESSION_KEY, 'true');
                showDashboard();
            } else {
                // ë¹„ë°€ë²ˆí˜¸ ë¶ˆì¼ì¹˜
                errorMsg.style.display = 'block';
                input.value = '';
                input.focus();

                // ì…ë ¥ í•„ë“œ í”ë“¤ê¸° íš¨ê³¼
                input.style.animation = 'shake 0.5s';
                setTimeout(() => {
                    input.style.animation = '';
                }, 500);
            }
        }

        // ëŒ€ì‹œë³´ë“œ í‘œì‹œ
        function showDashboard() {
            document.getElementById('authOverlay').style.display = 'none';
            document.getElementById('dashboardContent').classList.add('authenticated');

            // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
            loadDashboardData();
        }

        // ëŒ€ì‹œë³´ë“œ ë°ì´í„° ë¡œë“œ
        function loadDashboardData() {
            // localStorageì—ì„œ ì§„ë‹¨ ê¸°ë¡ ê°€ì ¸ì˜¤ê¸°
            const history = JSON.parse(localStorage.getItem('diagnosisHistory') || '[]');

            // ì‹¤ì œ ë°ì´í„°ê°€ ì—†ìœ¼ë©´ í…ŒìŠ¤íŠ¸ ë°ì´í„° ì‚¬ìš©
            if (history.length === 0) {
                console.log('ì‹¤ì œ ë°ì´í„°ê°€ ì—†ì–´ í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.');
                diagnosisData = convertTestDataToArray();
            } else {
                diagnosisData = history;
            }

            // í†µê³„ ê³„ì‚°
            updateStatistics();

            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            updateTable();
        }

        // í…ŒìŠ¤íŠ¸ ë°ì´í„°ë¥¼ ë°°ì—´ í˜•ì‹ìœ¼ë¡œ ë³€í™˜
        function convertTestDataToArray() {
            const arr = [];
            for (let key in testData) {
                const item = testData[key];
                arr.push({
                    id: 'test_' + key,
                    timestamp: new Date(item.date).getTime(),
                    clinicName: item.clinicName,
                    directorName: item.directorName,
                    region: item.region,
                    doctorCount: item.staff.match(/ì˜ì‚¬ (\d+)/)[1],
                    nurseCount: item.staff.match(/ê°„í˜¸ì‚¬ (\d+)/)[1],
                    counselorCount: item.staff.match(/ìƒë‹´ì‚¬ (\d+)/)[1],
                    date: item.date,
                    diagnosis1: item.diagnosis1 ? {
                        answers: [],
                        scores: item.diagnosis1.scores,
                        primaryType: {
                            type: item.diagnosis1.type.match(/(\d)í˜•/)[1],
                            name: item.diagnosis1.type.match(/\((.*)\)/)[1],
                            score: item.diagnosis1.score
                        },
                        secondaryType: {
                            type: item.diagnosis1.secondary.match(/(\d)í˜•/)[1],
                            name: item.diagnosis1.secondary.match(/\((.*)\)/)[1]
                        }
                    } : null,
                    diagnosis2: item.diagnosis2 ? {
                        answers: [],
                        essayAnswers: item.diagnosis2.essayAnswers || null,
                        // scores ë°°ì—´ì„ ê°ì²´ë¡œ ë³€í™˜ (A, B, C, D, E í‚¤ë¡œ)
                        scores: {
                            A: item.diagnosis2.scores[0],
                            B: item.diagnosis2.scores[1],
                            C: item.diagnosis2.scores[2],
                            D: item.diagnosis2.scores[3],
                            E: item.diagnosis2.scores[4]
                        },
                        primaryType: {
                            type: item.diagnosis2.type.match(/([A-E])í˜•/)[1],
                            name: item.diagnosis2.type.match(/\((.*)\)/)[1],
                            score: item.diagnosis2.score
                        },
                        secondaryType: {
                            type: item.diagnosis2.secondary.match(/([A-E])í˜•/)[1],
                            name: item.diagnosis2.secondary.match(/\((.*)\)/)[1]
                        }
                    } : null
                });
            }
            return arr;
        }

        // í†µê³„ ì—…ë°ì´íŠ¸
        function updateStatistics() {
            const total = diagnosisData.length;

            // ì˜¤ëŠ˜ ë‚ ì§œ (YYYY-MM-DD í˜•ì‹)
            const today = new Date().toISOString().split('T')[0];
            const todayCount = diagnosisData.filter(d => d.date && d.date.includes(today)).length;

            // 1ë²ˆ ì§„ë‹¨ ì™„ë£Œ ìˆ˜
            const diagnosis1Count = diagnosisData.filter(d => d.diagnosis1 !== null).length;

            // 2ë²ˆ ì§„ë‹¨ ì™„ë£Œ ìˆ˜
            const diagnosis2Count = diagnosisData.filter(d => d.diagnosis2 !== null).length;

            // í†µí•© ì™„ë£Œ ìˆ˜ (ë‘˜ ë‹¤ ì™„ë£Œ)
            const integratedCount = diagnosisData.filter(d => d.diagnosis1 !== null && d.diagnosis2 !== null).length;

            // HTML ì—…ë°ì´íŠ¸
            const statsHTML = `
                <div style="text-align: center; flex: 1; min-width: 100px;">
                    <div style="font-size: 1.8rem; font-weight: bold; color: #2563eb;">${total}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">ì´ ì§„ë‹¨ ìˆ˜</div>
                </div>
                <div style="height: 40px; width: 1px; background: #e5e7eb;"></div>
                <div style="text-align: center; flex: 1; min-width: 100px;">
                    <div style="font-size: 1.8rem; font-weight: bold; color: #10b981;">${todayCount}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">ì˜¤ëŠ˜ ì§„ë‹¨</div>
                </div>
                <div style="height: 40px; width: 1px; background: #e5e7eb;"></div>
                <div style="text-align: center; flex: 1; min-width: 100px;">
                    <div style="font-size: 1.8rem; font-weight: bold; color: #8b5cf6;">${diagnosis1Count}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">1ë²ˆ ì§„ë‹¨</div>
                </div>
                <div style="height: 40px; width: 1px; background: #e5e7eb;"></div>
                <div style="text-align: center; flex: 1; min-width: 100px;">
                    <div style="font-size: 1.8rem; font-weight: bold; color: #f59e0b;">${diagnosis2Count}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">2ë²ˆ ì§„ë‹¨</div>
                </div>
                <div style="height: 40px; width: 1px; background: #e5e7eb;"></div>
                <div style="text-align: center; flex: 1; min-width: 100px;">
                    <div style="font-size: 1.8rem; font-weight: bold; color: #ef4444;">${integratedCount}</div>
                    <div style="font-size: 0.85rem; color: #6b7280;">í†µí•© ì™„ë£Œ</div>
                </div>
            `;

            document.querySelector('.dashboard-content main > div:first-child > div').innerHTML = statsHTML;
        }

        // í…Œì´ë¸” ì—…ë°ì´íŠ¸
        function updateTable() {
            const tbody = document.getElementById('diagnosisTableBody');

            if (diagnosisData.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="9" style="padding: 40px; text-align: center; color: #6b7280;">
                            ì•„ì§ ë“±ë¡ëœ ì§„ë‹¨ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
                        </td>
                    </tr>
                `;
                return;
            }

            // ìµœì‹ ìˆœìœ¼ë¡œ ì •ë ¬
            const sortedData = [...diagnosisData].sort((a, b) => b.timestamp - a.timestamp);

            let html = '';
            sortedData.forEach((item, index) => {
                const staff = `ì˜${item.doctorCount}/ê°„${item.nurseCount}/ìƒ${item.counselorCount || 0}`;

                // 1ë²ˆ ì§„ë‹¨ ë±ƒì§€
                let diag1Badge = '<span style="background: #e5e7eb; color: #6b7280; padding: 4px 10px; border-radius: 12px; font-size: 0.8rem;">ë¯¸ì™„ë£Œ</span>';
                if (item.diagnosis1) {
                    const type = item.diagnosis1.primaryType.type;
                    const score = item.diagnosis1.primaryType.score;
                    const colors = {
                        '1': 'background: #fee2e2; color: #991b1b;',
                        '2': 'background: #fef3c7; color: #92400e;',
                        '3': 'background: #dbeafe; color: #1e40af;',
                        '4': 'background: #dbeafe; color: #1e40af;',
                        '5': 'background: #d1fae5; color: #065f46;'
                    };
                    diag1Badge = `<span style="${colors[type]} padding: 4px 10px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">${type}í˜•(${score}ì )</span>`;
                }

                // 2ë²ˆ ì§„ë‹¨ ë±ƒì§€
                let diag2Badge = '<span style="background: #e5e7eb; color: #6b7280; padding: 4px 10px; border-radius: 12px; font-size: 0.8rem;">ë¯¸ì™„ë£Œ</span>';
                if (item.diagnosis2) {
                    const type = item.diagnosis2.primaryType.type;
                    const score = item.diagnosis2.primaryType.score;
                    const colors = {
                        'A': 'background: #ede9fe; color: #6b21a8;',
                        'B': 'background: #d1fae5; color: #065f46;',
                        'C': 'background: #fef3c7; color: #92400e;',
                        'D': 'background: #ede9fe; color: #6b21a8;',
                        'E': 'background: #fee2e2; color: #991b1b;'
                    };
                    diag2Badge = `<span style="${colors[type]} padding: 4px 10px; border-radius: 12px; font-size: 0.8rem; font-weight: 600;">${type}í˜•(${score}ì )</span>`;
                }

                // ì´ë©”ì¼ ìš”ì²­ ì—¬ë¶€
                let emailBadge = '<span style="color: #9ca3af; font-size: 0.8rem;">-</span>';
                if (item.emailRequests) {
                    const hasEmail1 = item.emailRequests.diagnosis1 ? true : false;
                    const hasEmail2 = item.emailRequests.diagnosis2 ? true : false;

                    if (hasEmail1 && hasEmail2) {
                        emailBadge = '<span style="background: #10b981; color: white; padding: 3px 8px; border-radius: 10px; font-size: 0.75rem; font-weight: 600;">1+2</span>';
                    } else if (hasEmail1) {
                        emailBadge = '<span style="background: #2563eb; color: white; padding: 3px 8px; border-radius: 10px; font-size: 0.75rem; font-weight: 600;">1ë²ˆ</span>';
                    } else if (hasEmail2) {
                        emailBadge = '<span style="background: #8b5cf6; color: white; padding: 3px 8px; border-radius: 10px; font-size: 0.75rem; font-weight: 600;">2ë²ˆ</span>';
                    }
                }

                html += `
                    <tr style="border-bottom: 1px solid #e5e7eb;">
                        <td style="padding: 12px; font-size: 0.85rem; color: #4b5563;">${item.date || '-'}</td>
                        <td style="padding: 12px; font-size: 0.85rem; color: #1f2937; font-weight: 600;">${item.clinicName}</td>
                        <td style="padding: 12px; font-size: 0.85rem; color: #4b5563;">${item.directorName}</td>
                        <td style="padding: 12px; font-size: 0.85rem; color: #6b7280;">${item.region || '-'}</td>
                        <td style="padding: 12px; text-align: center; font-size: 0.8rem; color: #6b7280;">${staff}</td>
                        <td style="padding: 12px; text-align: center;">${diag1Badge}</td>
                        <td style="padding: 12px; text-align: center;">${diag2Badge}</td>
                        <td style="padding: 12px; text-align: center;">${emailBadge}</td>
                        <td style="padding: 12px; text-align: center;">
                            <button onclick="showDetail(${index})" style="background: #2563eb; color: white; border: none; padding: 6px 12px; border-radius: 6px; font-size: 0.8rem; cursor: pointer;">ë³´ê¸°</button>
                        </td>
                    </tr>
                `;
            });

            tbody.innerHTML = html;
        }

        // CSS ì• ë‹ˆë©”ì´ì…˜ ì¶”ê°€
        const style = document.createElement('style');
        style.textContent = `
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-10px); }
                75% { transform: translateX(10px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
